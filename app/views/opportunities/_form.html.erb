<%= form_with model: @opportunity, class: "space-y-8" do |f| %>
  <% if @opportunity.errors.any? %>
    <div class="rounded-xl border border-rose-200 bg-rose-50 p-4 text-rose-800">
      <p class="font-semibold mb-2"><%= pluralize(@opportunity.errors.count, "erreur") %> à corriger :</p>
      <ul class="list-disc pl-5 space-y-1">
        <% @opportunity.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- Identité -->
  <section class="bg-white rounded-xl border border-gray-100 p-6 shadow-sm">
    <h2 class="text-lg font-semibold mb-4">Informations générales</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <%= f.label :title, "Titre", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :title, required: true, class: "w-full rounded-lg border-gray-300", placeholder: "Ex. Bootcamp climat pour cadres" %>
      </div>
      <div>
        <%= f.label :organization, "Organisation", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :organization, class: "w-full rounded-lg border-gray-300", placeholder: "Nom de l'organisme" %>
      </div>

      <div>
        <%= f.label :category, "Catégorie", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.select :category,
          [["Bénévolat","benevolat"],["Formation","formation"],["Rencontres","rencontres"],["Entreprendre","entreprendre"]],
          { prompt: "Choisir..." },
          class: "w-full rounded-lg border-gray-300" %>
      </div>
      <div>
        <%= f.label :website, "Site / Page de l’opportunité", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.url_field :website, class: "w-full rounded-lg border-gray-300", placeholder: "https://..." %>
      </div>

      <div class="sm:col-span-2">
        <%= f.label :description, "Description", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_area :description, rows: 5, class: "w-full rounded-lg border-gray-300", placeholder: "Expliquez l'opportunité, le public visé, les résultats attendus (min. ~140 caractères)." %>
      </div>
    </div>
  </section>

  <!-- Logistique -->
  <section class="bg-white rounded-xl border border-gray-100 p-6 shadow-sm">
    <h2 class="text-lg font-semibold mb-4">Logistique</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <%= f.label :location, "Ville / Lieu", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :location, class: "w-full rounded-lg border-gray-300", placeholder: "Paris 10e, Nancy..." %>
      </div>
      <div class="grid grid-cols-2 gap-3">
        <div>
          <%= f.label :latitude, "Latitude", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.number_field :latitude, step: :any, class: "w-full rounded-lg border-gray-300" %>
        </div>
        <div>
          <%= f.label :longitude, "Longitude", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.number_field :longitude, step: :any, class: "w-full rounded-lg border-gray-300" %>
        </div>
      </div>

      <div>
        <%= f.label :format, "Format", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.select :format,
          [["Présentiel","présentiel"],["Distanciel","distanciel"],["Hybride","hybride"]],
          { prompt: "Choisir..." }, class: "w-full rounded-lg border-gray-300" %>
      </div>
      <div>
        <%= f.label :schedule, "Rythme", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.select :schedule,
          [["Soir & week-end","soir/week-end"],["Intensif","intensif"],["Temps plein","temps plein"],["Ponctuel","ponctuel"]],
          { prompt: "Choisir..." }, class: "w-full rounded-lg border-gray-300" %>
      </div>

      <div>
        <%= f.label :duration_weeks, "Durée (semaines)", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.number_field :duration_weeks, class: "w-full rounded-lg border-gray-300" %>
      </div>
      <div>
        <%= f.label :time_commitment, "Temps hebdo (ex. 4h/sem)", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :time_commitment, class: "w-full rounded-lg border-gray-300" %>
      </div>

      <div>
        <%= f.label :starts_at, "Début", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.datetime_local_field :starts_at, class: "w-full rounded-lg border-gray-300" %>
      </div>
      <div>
        <%= f.label :application_deadline, "Date limite de candidature", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.datetime_local_field :application_deadline, class: "w-full rounded-lg border-gray-300" %>
      </div>
    </div>
  </section>

  <!-- Carrière / Virage -->
  <section class="bg-white rounded-xl border border-gray-100 p-6 shadow-sm">
    <h2 class="text-lg font-semibold mb-4">Virage & résultats</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <%= f.label :audience_level, "Public cible", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.select :audience_level,
          [["En reconversion","reconversion"],["Cadre / Dir.","cadre/dir"],["Confirmé","confirme"],["Junior","junior"]],
          { prompt: "Choisir..." }, class: "w-full rounded-lg border-gray-300" %>
      </div>
      <div>
        <%= f.label :career_outcome, "Résultat visé", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.select :career_outcome,
          [["Reconversion","reconversion"],["Upskilling","upskilling"],["Networking","networking"],["Mise à l’épreuve","essai"],["Entrepreneuriat/Incubation","entreprendre"]],
          { prompt: "Choisir..." }, class: "w-full rounded-lg border-gray-300" %>
      </div>

      <div>
        <%= f.label :credential, "Certification", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.select :credential,
          [["Aucune",""],["Certificat","Certificat"],["RNCP","RNCP"],["Badge","Badge"]],
          { prompt: "Choisir..." }, class: "w-full rounded-lg border-gray-300" %>
      </div>
      <div class="grid grid-cols-3 gap-3">
        <div class="flex items-center gap-2">
          <%= f.check_box :mentorship, class: "rounded" %>
          <%= f.label :mentorship, "Mentorat" %>
        </div>
        <div class="flex items-center gap-2">
          <%= f.check_box :alumni_network, class: "rounded" %>
          <%= f.label :alumni_network, "Réseau alumni" %>
        </div>
        <div class="flex items-center gap-2">
          <%= f.check_box :hiring_partners, class: "rounded" %>
          <%= f.label :hiring_partners, "Partenaires emploi" %>
        </div>
      </div>

      <div class="sm:col-span-2">
        <%= f.label :skills, "Compétences visées (séparées par des virgules)", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :skills, class: "w-full rounded-lg border-gray-300", placeholder: "gestion de projet, dataviz, fundraising, ..." %>
      </div>
      <div class="sm:col-span-2">
        <%= f.label :prerequisites, "Prérequis", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_area :prerequisites, rows: 3, class: "w-full rounded-lg border-gray-300", placeholder: "Diplôme, années d’expérience, tests, etc." %>
      </div>
    </div>
  </section>

  <!-- Économie / accès -->
  <section class="bg-white rounded-xl border border-gray-100 p-6 shadow-sm">
    <h2 class="text-lg font-semibold mb-4">Coûts & accès</h2>
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
      <div>
        <%= f.label :cost_eur, "Coût (€)", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.number_field :cost_eur, step: "0.01", class: "w-full rounded-lg border-gray-300" %>
      </div>
      <div class="flex items-center gap-2">
        <%= f.check_box :is_free, class: "rounded" %>
        <%= f.label :is_free, "Gratuit" %>
      </div>
      <div class="flex items-center gap-2">
        <%= f.check_box :scholarship_available, class: "rounded" %>
        <%= f.label :scholarship_available, "Bourses / financements" %>
      </div>

      <div class="sm:col-span-3">
        <%= f.label :funding_options, "Dispositifs (CPF, bourses…)", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :funding_options, class: "w-full rounded-lg border-gray-300" %>
      </div>
      <div class="sm:col-span-3">
        <%= f.label :accessibility, "Accessibilité", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_area :accessibility, rows: 2, class: "w-full rounded-lg border-gray-300" %>
      </div>
    </div>
  </section>

  <!-- Impact -->
  <section class="bg-white rounded-xl border border-gray-100 p-6 shadow-sm">
    <h2 class="text-lg font-semibold mb-4">Impact</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <%= f.label :impact_domains, "Domaines (séparés par virgules)", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :impact_domains, class: "w-full rounded-lg border-gray-300", placeholder: "climat, éducation, santé, ESS…" %>
      </div>
      <div>
        <%= f.label :selectivity_level, "Sélectivité", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.select :selectivity_level,
          [["Ouvert","ouvert"],["Dossier","dossier"],["Sélectif / Entretien","sélectif"]],
          { prompt: "Choisir..." }, class: "w-full rounded-lg border-gray-300" %>
      </div>

      <div class="sm:col-span-2">
        <%= f.label :impact_metric_hint, "Indicateur d’impact (optionnel)", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :impact_metric_hint, class: "w-full rounded-lg border-gray-300", placeholder: "ex. 100 bénéficiaires/mois" %>
      </div>
    </div>
  </section>

  <!-- Contact / Divers -->
  <section class="bg-white rounded-xl border border-gray-100 p-6 shadow-sm">
    <h2 class="text-lg font-semibold mb-4">Contact & Divers</h2>
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
      <div>
        <%= f.label :contact_email, "Email", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.email_field :contact_email, class: "w-full rounded-lg border-gray-300" %>
      </div>
      <div>
        <%= f.label :contact_phone, "Téléphone", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :contact_phone, class: "w-full rounded-lg border-gray-300" %>
      </div>
      <div>
        <%= f.label :tags, "Tags (CSV)", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :tags, class: "w-full rounded-lg border-gray-300", placeholder: "soirs, senior, climat..." %>
      </div>
    </div>
  </section>

  <div class="flex items-center justify-end gap-3">
    <%= link_to "Annuler", root_path, class: "px-4 py-2 rounded-lg border text-gray-700 hover:bg-gray-50" %>
    <%= f.submit "Envoyer l’opportunité",
      class: "px-5 py-3 rounded-lg bg-indigo-600 text-white font-semibold hover:bg-indigo-700" %>
  </div>
<% end %>

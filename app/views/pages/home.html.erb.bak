<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>D√©clic ‚Äî Trouvez votre prochaine opportunit√© de changement</title>
  <meta name="description" content="B√©n√©volat, formations, rencontres, reconversion‚Ä¶ D√©couvrez des opportunit√©s pr√®s de chez vous.">

  <!-- Tailwind (CDN pour la maquette) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter','ui-sans-serif','system-ui'] },
          colors: { brand: { 600:'#4f46e5', 700:'#4338ca' } }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

  <style>
    body { font-family: 'Inter', sans-serif; }
    /* Hauteur de carte responsive */
    #map { height: 360px; } @media (min-width:1024px){ #map{ height:420px; } }
    /* Espace sous header fixe */
    :root { --safe-top: env(safe-area-inset-top, 0px); }
    .hero-pad { padding-top: calc(64px + var(--safe-top)); }
    /* Pins emoji */
    .picon{ width:26px;height:26px;border-radius:9999px;border:2px solid #fff;display:grid;place-items:center;
      color:#fff;font-size:14px;box-shadow:0 1px 4px rgba(0,0,0,.25);position:relative;background:var(--c,#6366f1);}
    .picon::after{content:"";position:absolute;left:50%;bottom:-6px;transform:translateX(-50%);
      border:6px solid transparent;border-top-color:var(--c,#6366f1);}
    /* Chips */
    .chip{ transition:.15s; } .chip.is-active{ background:#111827;color:#fff; }
    /* Drawer: cach√© par d√©faut (√©vite chevauchements) */
    #mobile-menu[aria-hidden="true"]{ display:none!important; }
  </style>
</head>

<body class="bg-gray-50 text-gray-900">
<div class="flex min-h-screen flex-col">

  <!-- ===== Header fixe ===== -->

  <section class="relative hero-pad">
    <div class="absolute inset-0">
      <img src="https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?q=80&w=1920&auto=format&fit=crop" alt="" class="w-full h-full object-cover"/>
    </div>
    <div class="absolute inset-0 bg-gradient-to-r from-fuchsia-800/70 via-purple-700/65 to-emerald-600/60 mix-blend-multiply"></div>

    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 sm:py-12">
      <div class="max-w-3xl">
        <h1 class="text-white text-4xl sm:text-5xl lg:text-6xl font-extrabold leading-tight">
          Trouvez votre prochaine<br/><span class="text-yellow-300">opportunit√© de changement</span>
        </h1>
        <p class="mt-4 text-base sm:text-lg text-white/90 max-w-2xl">B√©n√©volat, formations, rencontres, reconversion‚Ä¶ D√©couvrez des milliers d‚Äôopportunit√©s pr√®s de chez vous.</p>

        <div class="mt-6 flex flex-col sm:flex-row gap-3">
          <a href="#explorer" class="inline-flex items-center justify-center px-4 py-2.5 rounded-lg bg-white text-gray-900 font-semibold hover:bg-gray-50"><span class="mr-2">üó∫Ô∏è</span> Explorer la carte</a>
          <form action="#explorer" class="flex-1 min-w-0">
            <div class="flex items-center bg-white/95 rounded-lg overflow-hidden shadow-sm">
              <span class="pl-3"><svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-4.35-4.35M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0z"/></svg></span>
              <input type="text" placeholder="Ville, th√®me, organisation‚Ä¶" class="w-full px-3 py-2.5 bg-transparent focus:outline-none"/>
              <button class="px-4 py-2.5 bg-brand-600 text-white font-medium hover:bg-brand-700">Rechercher</button>
            </div>
          </form>
        </div>

        <ul class="mt-4 flex flex-col sm:flex-row gap-3 sm:gap-6 text-white/95 text-sm">
          <li class="flex items-center"><span class="mr-2">‚úÖ</span><span><strong>15 000+</strong> opportunit√©s r√©f√©renc√©es</span></li>
          <li class="flex items-center"><span class="mr-2">üó∫Ô∏è</span><span><strong>Toute la France</strong> couverte</span></li>
          <li class="flex items-center"><span class="mr-2">üíú</span><span><strong>Gratuit</strong> et accessible √† tous</span></li>
        </ul>
      </div>
    </div>
  </section>

  <!-- ===== Contenu ===== -->
  <main class="flex-1">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
      <!-- IMPORTANT: min-w-0 partout + ordres mobiles -->
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8 items-start">

<!-- Colonne ‚ÄúChoisissez votre parcours‚Äù (cach√©e sur mobile, ++ grande sur desktop) -->
<div id="parcours"
     class="block order-1 lg:order-none col-span-12 lg:col-span-4 min-w-0 space-y-6">



  <!-- Je veux entreprendre (entreprendre) -->
  <%= link_to parcours_path(category: "entreprendre"),
      class: "block rounded-2xl p-6 lg:p-8 text-white shadow-md transition hover:shadow-lg",
      style: "background:linear-gradient(135deg,#f59e0b 0%,#ef4444 50%,#fb7185 100%);" do %>
    <div class="flex items-start gap-4 lg:gap-5">
      <span class="inline-flex h-12 w-12 lg:h-16 lg:w-16 items-center justify-center rounded-xl bg-white/20 text-2xl lg:text-3xl">üöÄ</span>
      <div class="min-w-0">
        <p class="font-semibold text-lg lg:text-xl">Je veux entreprendre</p>
        <p class="text-white/90 text-[15px] lg:text-base leading-snug">
          Lance ton projet avec le soutien d‚Äôentrepreneurs exp√©riment√©s
        </p>
      </div>
    </div>
  <% end %>


  <!-- Je veux me former(formation) -->
  <%= link_to parcours_path(category: "formation"),
      class: "block rounded-2xl p-6 lg:p-8 text-white shadow-md transition hover:shadow-lg",
      style: "background:linear-gradient(135deg,#6366f1 0%,#38bdf8 100%);" do %>
    <div class="flex items-start gap-4 lg:gap-5">
      <span class="inline-flex h-12 w-12 lg:h-16 lg:w-16 items-center justify-center rounded-xl bg-white/20 text-2xl lg:text-3xl">üìò</span>
      <div class="min-w-0">
        <p class="font-semibold text-lg lg:text-xl">Je veux me former</p>
        <p class="text-white/90 text-[15px] lg:text-base leading-snug">
          D√©couvre des formations pour d√©velopper tes comp√©tences
        </p>
      </div>
    </div>
  <% end %>

    <!-- Je veux aider (b√©n√©volat) -->
  <%= link_to parcours_path(category: "benevolat"),
      class: "block rounded-2xl p-6 lg:p-8 text-white shadow-md transition hover:shadow-lg",
      style: "background:linear-gradient(135deg,#f43f5e 0%,#ec4899 100%);" do %>
    <div class="flex items-start gap-4 lg:gap-5">
      <span class="inline-flex h-12 w-12 lg:h-16 lg:w-16 items-center justify-center rounded-xl bg-white/20 text-2xl lg:text-3xl">‚ù§Ô∏è</span>
      <div class="min-w-0">
        <p class="font-semibold text-lg lg:text-xl">Je veux aider</p>
        <p class="text-white/90 text-[15px] lg:text-base leading-snug">
          Trouve des missions de b√©n√©volat qui correspondent √† tes valeurs
        </p>
      </div>
    </div>
  <% end %>

  <!-- Je veux rencontrer (rencontres) -->
  <%= link_to parcours_path(category: "rencontres"),
      class: "block rounded-2xl p-6 lg:p-8 text-white shadow-md transition hover:shadow-lg",
      style: "background:linear-gradient(135deg,#10b981 0%,#06b6d4 100%);" do %>
    <div class="flex items-start gap-4 lg:gap-5">
      <span class="inline-flex h-12 w-12 lg:h-16 lg:w-16 items-center justify-center rounded-xl bg-white/20 text-2xl lg:text-3xl">ü§ù</span>
      <div class="min-w-0">
        <p class="font-semibold text-lg lg:text-xl">Je veux rencontrer</p>
        <p class="text-white/90 text-[15px] lg:text-base leading-snug">
          Rejoins des communaut√©s et cr√©e des liens authentiques
        </p>
      </div>
    </div>
  <% end %>

<!-- Belles histoires -->
<%= link_to stories_path(category: "belles_histoires"),
    class: "block rounded-2xl p-6 lg:p-8 text-white shadow-md transition hover:shadow-lg",
    style: "background:linear-gradient(135deg,#6d28d9 0%,#a855f7 50%,#d946ef 100%);" do %>
  <div class="flex items-start gap-4 lg:gap-5">
    <span class="inline-flex h-12 w-12 lg:h-16 lg:w-16 items-center justify-center rounded-xl bg-white/20 text-2xl lg:text-3xl">üìñ</span>
    <div class="min-w-0">
      <p class="font-semibold text-lg lg:text-xl">Belles histoires</p>
      <p class="text-white/90 text-[15px] lg:text-base leading-snug">
        D√©couvrez des reconversions et des "d√©clics" inspirants
      </p>
    </div>
  </div>
<% end %>



</div>



        <!-- Carte ‚Äî 2e en mobile -->
        <section id="explorer" class="order-2 lg:order-none col-span-12 lg:col-span-4 min-w-0">
          <h2 class="text-2xl sm:text-3xl font-extrabold">Explorez les opportunit√©s</h2>
          <p class="text-gray-600 mt-2">D√©couvrez sur la carte toutes les possibilit√©s d‚Äôengagement pr√®s de chez vous</p>

          <div class="mt-4 flex flex-wrap gap-2 text-sm">
            <button data-cat="toutes"       class="chip px-3 py-1 rounded-full bg-gray-200 text-gray-800 is-active">Toutes</button>
            <button data-cat="benevolat"    class="chip px-3 py-1 rounded-full bg-rose-100 text-rose-700">B√©n√©volat</button>
            <button data-cat="formation"    class="chip px-3 py-1 rounded-full bg-blue-100 text-blue-700">Formation</button>
            <button data-cat="rencontres"   class="chip px-3 py-1 rounded-full bg-green-100 text-green-700">Rencontres</button>
            <button data-cat="entreprendre" class="chip px-3 py-1 rounded-full bg-orange-100 text-orange-700">Entreprendre</button>
          </div>

          <div class="mt-4 bg-white rounded-2xl shadow overflow-hidden">
            <div id="map"></div>
          </div>
        </section>

        <!-- Liste ‚Äî 3e en mobile, LIMIT√âE √Ä 3 -->
        <section class="order-3 lg:order-none col-span-12 lg:col-span-4 min-w-0">
          <h2 class="text-2xl sm:text-3xl font-extrabold">Quelques opportunit√©s</h2>
          <p class="text-gray-600 mt-2">Les derni√®res missions et √©v√©nements pr√®s de chez vous</p>

          <div class="mt-6 space-y-4">
            <% Array(@opportunities).first(3).to_a.each do |o| %>
              <article class="bg-white rounded-xl shadow-sm border border-gray-100 p-4 hover:shadow-md transition">
                <div class="flex items-center gap-2 mb-2">
                  <% badge = case o.category
                    when 'benevolat' then 'bg-rose-100 text-rose-700'
                    when 'formation' then 'bg-blue-100 text-blue-700'
                    when 'rencontres' then 'bg-green-100 text-green-700'
                    else 'bg-orange-100 text-orange-700'
                  end %>
                  <span class="text-xs font-semibold px-2 py-1 rounded-full <%= badge %>"><%= o.category.to_s.capitalize %></span>
                </div>
                <h3 class="font-semibold text-gray-900 truncate"><%= o.title %></h3>
                <p class="text-sm text-gray-600"><%= o.organization %></p>
                <p class="text-sm text-gray-700 mt-2"><%= o.description.to_s.truncate(110) %></p>
                <div class="mt-3 flex items-center justify-between">
                  <div class="flex items-center gap-3 text-xs text-gray-500">
                    <% if o.location.present? %><span>üìç <%= o.location %></span><% end %>
                    <% if o.time_commitment.present? %><span>‚è± <%= o.time_commitment %></span><% end %>
                  </div>
                  <a href="/opportunities/<%= o.respond_to?(:slug) && o.slug.present? ? o.slug : o.id %>" class="inline-flex items-center px-3 py-1.5 rounded-lg bg-brand-600 text-white text-xs font-medium hover:bg-brand-700">En savoir plus</a>
                </div>
              </article>
            <% end %>
          </div>
        </section>

      </div>
    </div>

    <!-- T√©moignages -->
    <section id="temoignages" class="bg-white py-14">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-10">
          <h2 class="text-2xl sm:text-3xl font-extrabold">Ils ont chang√© leur vie</h2>
          <p class="text-gray-600 mt-2">Histoires vraies de personnes qui ont trouv√© leur D√©clic</p>
        </div>
        <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
          <% Array(@testimonials).first(4).to_a.each do |t| %>
            <article class="bg-gray-50 rounded-xl border border-gray-100 shadow-sm p-6">
              <div class="flex items-center gap-3 mb-4">

<% logical = t.image_url.to_s.sub(%r{\A/assets/}, '') %>
<% logical = 'avatars/default-avatar.png' unless asset_exists?(logical) %>
<%= image_tag logical, alt: t.name, class: "w-12 h-12 rounded-full object-cover" %>


                <div class="min-w-0">
                  <h3 class="font-semibold truncate"><%= t.name %></h3>
                  <p class="text-xs text-gray-500"><%= t.role %> ‚Äî <%= t.age %> ans</p>
                </div>
              </div>
              <p class="text-gray-700 text-sm leading-relaxed"><%= t.story %></p>
            </article>
          <% end %>
        </div>
      </div>
    </section>
  </main>

  <!-- ===== Footer ===== -->
  <footer class="bg-gray-950 text-white py-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center gap-2 mb-2">
        <div class="w-7 h-7 rounded-lg bg-gradient-to-br from-fuchsia-600 via-purple-600 to-indigo-600 grid place-content-center">
          <span class="text-white font-bold text-[10px]">D</span>
        </div>
        <span class="font-semibold">D√©clic</span>
      </div>
      <p class="text-gray-300 max-w-md">Trouvez votre voie vers l‚Äôengagement et donnez du sens √† votre vie.</p>
      <p class="text-gray-400 mt-3 text-sm">¬© <%= Time.current.year %> D√©clic. Tous droits r√©serv√©s.</p>
    </div>
  </footer>
</div>

<!-- Leaflet -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
